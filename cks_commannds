sh ./Assessor-CLI.sh -i -rd /var/www/html/ -nts -rp index    - os level
curl -L https://github.com/aquasecurity/kube-bench/releases/download/v0.4.0/kube-bench_0.4.0_linux_amd64.tar.gz -o kube-bench_0.4.0_linux_amd64.tar.gz
tar -xvf kube-bench_0.4.0_linux_amd64.tar.gz
check the kube bench doccumentation
openssl x509 -in /etc/kubernetes/pki/ca.crt -text
cat akshay.csr | base64 -w 0
k config --kubeconfig /root/my-kube-config current-context
k config --kubeconfig /root/my-kube-config use-context research
10250: full acess and 10255 is read only access
k exec ubuntu-sleeper -- whoami
kubectl exec -it kube-apiserver-controlplane -n kube-system -- kube-apiserver -h | grep 'enable-admission-plugins'
ps -ef | grep kube-apiserver | grep admission-plugins
k get ns --show-labels
53 tcp/udp port only for egress rules 
kubectl create configmap untrusted-registry --from-file=untrusted-registry.rego

envFrom:
      - secretRef:
          name: mysecret
          
          

runc - default container run time responsible for creating the container
 k get runtimeclasses
  k describe runtimeclasses gvisor
  kubesec scan /root/node.yaml  > /root/kubesec_report.json

trivy -h
trivy -v
trivy image --severity HIGH --output /root/python.txt python:3.10.0a4-alpine
trivy image --input alpine.tar --format json --output /root/alpine.json
 systemctl status falco
 journalctl -u falco
 journalctl -fu falco
 readOnlyRootFilesystem: true & previlized is false for immutable fs and add volumes
 passwd david
 deluser ray
 delgroup devs
echo "text" | base64 --decode
cat csr | base64 | tr -d '\n'
usermod -s /usr/sbin/nologin himanshi
adduser jim
ssh-copy-id -i ~/.ssh/id_rsa.pub jim@node01
jim ALL=(ALL:ALL) ALL
jim ALL=(ALL) NOPASSWD:ALL
usermod rob -G admin - add user to a group
%admin ALL=(ALL) ALL
/etc/ssh/sshd_config
----------------
PermitRootLogin no
PasswordAuthentication no
service sshd restart
----------------------

apt list --installed
systemctl list-units --type service
lsmod
vim /etc/modprobe.d/blacklist.conf   > need reboot after this
apt remove nginx -y
apt install wget -y
systemctl status ufw or ufw status
ufw status numbered
ufw allow 1000:2000/tcp
ufw reset
ufw allow from 135.22.65.0/24 to any port 9091 proto tcp
ufw enable
ufw deny 80
ufw disable
strace -c ls /root
/var/lib/kubelet/seccomp default seccomp profile

---------------
spec:
  securityContext:
    seccompProfile:
      type: Localhost
      localhostProfile: profiles/audit.js
      ---------------------
      
      
  apparmor-parser -q /etc/apparmor.d/file
  
  metadata:
  annotations:
    container.apparmor.security.beta.kubernetes.io/nginx: localhost/restricted-nginx
 
 
 kubectl create configmap unique-host --from-file=/root/unique-host.rego
 
 
    
    
    
 







 
 
 
 
 
 
 
 
 
 
 
 
 
      
